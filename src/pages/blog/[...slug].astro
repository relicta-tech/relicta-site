---
import { getCollection } from 'astro:content';
import SiteLayout from '../../layouts/SiteLayout.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}

const post = Astro.props;
const { Content } = await post.render();
---

<SiteLayout title={post.data.title} description={post.data.description}>
	<article class="blog-post">
		<header class="post-header">
			<p class="eyebrow">{post.data.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
			<h1>{post.data.title}</h1>
			<p class="lede">{post.data.description}</p>
		</header>
		<hr class="divider" />
		<div class="content">
			<Content />
		</div>
	</article>
</SiteLayout>

<style is:global>
	.blog-post {
		max-width: 800px;
		margin: 0 auto;
		padding: 40px 0;
	}
	.post-header {
		margin-bottom: 32px;
	}
	.post-header h1 {
		margin: 16px 0;
		font-size: 3rem;
	}
	.divider {
		border: 0;
		border-top: 1px solid var(--color-border);
		margin: 32px 0;
	}
	.content {
		line-height: 1.8;
		font-size: 1.1rem;
		color: var(--color-muted);
	}
	.content h2 {
		color: var(--color-text);
		margin-top: 48px;
		margin-bottom: 16px;
	}
	.content p {
		margin-bottom: 24px;
	}
	.content blockquote {
		border-left: 4px solid var(--color-accent);
		margin: 32px 0;
		padding: 16px 24px;
		background: rgba(92, 240, 200, 0.05);
		font-style: italic;
		color: var(--color-text);
	}
    .content blockquote p {
        margin-bottom: 0;
    }
	.content ul {
		margin-bottom: 24px;
		padding-left: 24px;
	}
	.content li {
		margin-bottom: 8px;
	}
	.content pre {
		margin: 32px 0;
	}
    /* Mermaid support would usually need a plugin, for now we just style the code block */
    .content code {
        background: rgba(255, 255, 255, 0.1);
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 0.9em;
    }
    .content pre code {
        background: transparent;
        padding: 0;
    }
</style>
