---
import BaseLayout from "../layouts/BaseLayout.astro";

const title = "Relicta — AI-powered release management";
const description = "Relicta is an AI-powered release management CLI that automates versioning, release notes, approvals, and publishing.";

const getLatestVersion = async () => {
  try {
    const res = await fetch("https://api.github.com/repos/relicta-tech/relicta/releases/latest", {
      headers: { "User-Agent": "relicta-site" },
    });
    if (!res.ok) throw new Error(`GitHub responded ${res.status}`);
    const json = await res.json();
    return json.tag_name || "v2.1.0";
  } catch (err) {
    return "v2.1.0";
  }
};

const version = await getLatestVersion();
---
<BaseLayout {title} {description}>
  <header class="top-bar">
    <div class="brand">
      <div class="brand-logos">
        <img src="/brand/relicta-logo-light.svg" alt="Relicta" class="brand-mark logo-light" />
        <img src="/brand/relicta-logo-dark.svg" alt="Relicta" class="brand-mark logo-dark" />
      </div>
    </div>
    <button class="menu-toggle" type="button" aria-label="Toggle navigation menu" aria-expanded="false" data-menu-toggle>
      <span class="menu-icon"></span>
    </button>
    <nav class="nav" id="main-nav">
      <a href="#features">Features</a>
      <a href="#plugins">Plugins</a>
      <a href="#governance">Governance</a>
      <a href="https://docs.relicta.tech" target="_blank" rel="noopener">Docs</a>
      <a href="#install">Install</a>
      <a href="https://github.com/relicta-tech/relicta" target="_blank" rel="noopener">GitHub</a>
    </nav>
    <div class="cta">
      <button class="theme-toggle" type="button" data-theme-toggle aria-pressed="false">Toggle theme</button>
      <a class="btn ghost" href="https://github.com/relicta-tech/relicta/releases/latest">Download</a>
      <a class="btn solid" href="https://github.com/relicta-tech/relicta-action" target="_blank" rel="noopener">Use in CI</a>
    </div>
  </header>
  <script>
    // Mobile menu toggle
    document.addEventListener('DOMContentLoaded', () => {
      const toggle = document.querySelector('[data-menu-toggle]');
      const nav = document.getElementById('main-nav');
      const cta = document.querySelector('.top-bar .cta');

      if (!toggle || !nav) return;

      toggle.addEventListener('click', () => {
        const isOpen = toggle.getAttribute('aria-expanded') === 'true';
        toggle.setAttribute('aria-expanded', !isOpen);
        nav.classList.toggle('nav-open', !isOpen);
        cta.classList.toggle('cta-open', !isOpen);
        document.body.classList.toggle('menu-open', !isOpen);
      });

      // Close menu when clicking a nav link
      nav.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', () => {
          toggle.setAttribute('aria-expanded', 'false');
          nav.classList.remove('nav-open');
          cta.classList.remove('cta-open');
          document.body.classList.remove('menu-open');
        });
      });
    });
  </script>

  <main id="main">
    <section class="hero">
      <div class="hero-text">
        <p class="eyebrow">AI-powered release management</p>
        <h1>Ship clean releases without the release-day scramble</h1>
        <p class="lede">Relicta reads your commits, calculates the right semantic version, writes polished notes, and publishes across your channels. One CLI for the entire release workflow.</p>
        <div class="hero-actions">
          <a class="btn solid" href="#install">Get the CLI</a>
          <a class="btn ghost" href="https://github.com/relicta-tech/relicta" target="_blank" rel="noopener">View on GitHub</a>
        </div>
        <div class="hero-meta">
          <span>Latest CLI: {version}</span>
          <span class="divider">•</span>
          <span>20 official plugins for GitHub, npm, Docker, PyPI, and more</span>
          <span class="divider">•</span>
          <span>Supports OpenAI, Anthropic, Gemini, Azure, Ollama</span>
        </div>
      </div>
      <div class="hero-card">
        <div class="terminal">
          <img src="/demos/marketing.gif" alt="Relicta CLI run showing plan, notes, and publish steps" loading="lazy" />
        </div>
        <div class="card-foot">Designed for modern teams that care about release quality.</div>
      </div>
    </section>

    <section id="features" class="section grid reveal">
      <div class="section-heading">
        <p class="eyebrow">Why teams choose Relicta</p>
        <h2>Automate the boring parts, keep humans in control</h2>
        <p class="lede">Relicta combines conventional commits, AI summaries, and an approval flow so you can ship confidently every time.</p>
        <div class="feature-list">
          <div>
            <h4>Core workflow</h4>
            <ul>
              <li>Semantic versioning from conventional commits</li>
              <li>AI-generated notes with tone control</li>
              <li>Approval gate before publishing</li>
              <li>Dry runs to preview changes safely</li>
            </ul>
          </div>
          <div>
            <h4>Integrations</h4>
            <ul>
              <li>20 official plugins: GitHub, GitLab, npm, PyPI, Docker, Homebrew, and more</li>
              <li>Supports OpenAI, Anthropic, Gemini, Azure, Ollama</li>
              <li>GitHub Action for zero-install CI</li>
              <li>Extensible via gRPC plugin SDK</li>
            </ul>
          </div>
        </div>
      </div>
      <div class="feature-cards">
        <article class="card">
          <h3>Automatic versioning</h3>
          <p>Relicta reads your history and calculates the correct semantic version, including prereleases and build metadata.</p>
        </article>
        <article class="card">
          <h3>AI-grade release notes</h3>
          <p>Generate polished notes with your preferred AI provider (OpenAI, Anthropic, Gemini, Azure, Ollama) and keep them consistent.</p>
        </article>
        <article class="card">
          <h3>Pluggable publishing</h3>
          <p>Ship to 20+ targets: GitHub, GitLab, npm, PyPI, Docker, Homebrew, Slack, Teams, and more. Build custom plugins with the gRPC SDK.</p>
        </article>
        <article class="card">
          <h3>Approval workflow</h3>
          <p>Plan, review, and approve before publishing. Dry runs let you see every change without touching your repo.</p>
        </article>
        <article class="card">
          <h3>CI-first</h3>
          <p>Use the GitHub Action for zero-install pipelines or run the binary directly. Checksums included for every release.</p>
        </article>
        <article class="card">
          <h3>Friendly CLI</h3>
          <p>Guided setup, JSON output for automation, and sensible defaults so you get value in minutes.</p>
        </article>
      </div>
    </section>

    <section id="plugins" class="section plugins reveal">
      <div class="section-heading">
        <p class="eyebrow">Ecosystem</p>
        <h2>20 Official Plugins</h2>
        <p class="lede">Publish to every major platform with zero configuration. All plugins are open source and installable via the CLI.</p>
      </div>
      <div class="plugin-grid">
        <div class="plugin-category">
          <h4>Version Control</h4>
          <ul class="plugin-list">
            <li><strong>github</strong> - Create releases &amp; upload assets</li>
            <li><strong>gitlab</strong> - Create GitLab releases</li>
          </ul>
        </div>
        <div class="plugin-category">
          <h4>Notifications</h4>
          <ul class="plugin-list">
            <li><strong>slack</strong> - Slack channel notifications</li>
            <li><strong>discord</strong> - Discord webhook messages</li>
            <li><strong>teams</strong> - Microsoft Teams cards</li>
          </ul>
        </div>
        <div class="plugin-category">
          <h4>Package Managers</h4>
          <ul class="plugin-list">
            <li><strong>npm</strong> - npm registry</li>
            <li><strong>pypi</strong> - Python Package Index</li>
            <li><strong>homebrew</strong> - Homebrew formulas</li>
            <li><strong>chocolatey</strong> - Windows packages</li>
            <li><strong>linuxpkg</strong> - deb, rpm, apk</li>
            <li><strong>crates</strong> - Rust crates.io</li>
            <li><strong>nuget</strong> - .NET packages</li>
            <li><strong>maven</strong> - Maven Central</li>
            <li><strong>rubygems</strong> - Ruby gems</li>
            <li><strong>hex</strong> - Elixir/Erlang Hex.pm</li>
            <li><strong>packagist</strong> - PHP Composer</li>
            <li><strong>gomod</strong> - Go modules</li>
          </ul>
        </div>
        <div class="plugin-category">
          <h4>Project Management</h4>
          <ul class="plugin-list">
            <li><strong>jira</strong> - Jira release versions</li>
            <li><strong>launchnotes</strong> - Customer announcements</li>
          </ul>
        </div>
        <div class="plugin-category">
          <h4>Containers</h4>
          <ul class="plugin-list">
            <li><strong>docker</strong> - Build &amp; push images</li>
          </ul>
        </div>
      </div>
      <div class="plugin-cta">
        <p>Install any plugin with one command:</p>
        <pre><code>relicta plugin install github npm docker slack</code></pre>
        <a class="btn ghost" href="https://docs.relicta.tech/plugins" target="_blank" rel="noopener">View all plugin docs</a>
      </div>
    </section>

    <section id="governance" class="section grid reveal">
      <div class="section-heading">
        <p class="eyebrow">New in v2.2</p>
        <h2>Change Governance Protocol (CGP)</h2>
        <p class="lede">Built-in risk assessment and governance for AI-assisted and agentic workflows. Keep humans in control of high-impact changes.</p>
      </div>
      <div class="feature-cards">
        <article class="card">
          <h3>Risk assessment</h3>
          <p>Automatic risk scoring based on blast radius, actor trust level, and security impact of changes.</p>
        </article>
        <article class="card">
          <h3>Security detection</h3>
          <p>Automatically detects security-related commits via scope patterns and keywords. Flags auth, crypto, and vulnerability fixes.</p>
        </article>
        <article class="card">
          <h3>Policy engine</h3>
          <p>Configurable policies with conditions and actions. Require human approval for breaking changes or high-risk releases.</p>
        </article>
        <article class="card">
          <h3>Release memory</h3>
          <p>Historical tracking of releases, incidents, and actor behavior for continuous improvement of risk assessment.</p>
        </article>
      </div>
      <div class="demo-card-media" style="margin-top: 2rem;">
        <div class="demo-label">CGP in action</div>
        <img src="/demos/CGP.gif" alt="CGP governance preview showing risk score and approval requirements" loading="lazy" />
      </div>
    </section>

    <section class="section demo reveal">
      <div class="section-heading">
        <p class="eyebrow">Demo the flow</p>
        <h2>Everything from planning to publishing in one CLI</h2>
        <p class="lede">One command or step-by-step control. The output stays predictable and copy-paste ready.</p>
      </div>
      <div class="demo-grid demo-grid-3">
        <div class="demo-card demo-card-featured">
          <div class="demo-label">One Command (Recommended)</div>
<pre><code><span class="cmd-prompt">$</span> relicta release

<span class="cmd-step">→ Planning...</span>
  ✓ Analyzed 12 commits since v2.5.0
  ✓ Next version: 2.6.0 (minor)

<span class="cmd-step">→ Bumping version...</span>
  ✓ Created tag v2.6.0

<span class="cmd-step">→ Generating notes...</span>
  ✓ AI-powered release notes ready
  ✓ CHANGELOG.md updated

<span class="cmd-step">→ Approving...</span>
  ✓ Risk score: 18% (low)
  ✓ Release approved

<span class="cmd-step">→ Publishing...</span>
  ✓ Tag pushed to origin
  ✓ GitHub release created
  ✓ Slack notification sent

<span class="cmd-success">✨ Released v2.6.0</span></code></pre>
          <p class="demo-note">For CI/CD: <code>relicta release --yes</code></p>
        </div>
        <div class="demo-card">
          <div class="demo-label">Step-by-Step</div>
<pre><code><span class="cmd-prompt">$</span> relicta plan
✓ Detects next version from commits
✓ Shows diff, change types, release type

<span class="cmd-prompt">$</span> relicta bump
✓ Applies version, creates git tag

<span class="cmd-prompt">$</span> relicta notes --ai
✓ Generates release notes + changelog
✓ Uses your preferred AI provider

<span class="cmd-prompt">$</span> relicta approve
✓ Locks the plan with auditability

<span class="cmd-prompt">$</span> relicta publish
✓ Tags repo, runs plugins, posts release</code></pre>
        </div>
        <div class="demo-card">
          <div class="demo-label">GitHub Action</div>
<pre><code>name: Release
on:
  push:
    branches: [main]

jobs:
  release:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: relicta-tech/relicta-action@v2
        with:
          github-token: &#36;&#123;&#123; secrets.GITHUB_TOKEN &#125;&#125;</code></pre>
          <p class="demo-note">Zero-install CI: downloads binary, verifies checksums, runs the full workflow.</p>
        </div>
      </div>
      <div class="demo-video">
        <p class="demo-label">See CI/CD in action</p>
        <video controls>
          <source src="/videos/cicd.mp4" type="video/mp4" />
          Your browser does not support the video tag.
        </video>
      </div>
    </section>

    <section class="section preview reveal">
      <div class="section-heading">
        <p class="eyebrow">See it in action</p>
        <h2>Release checklist and approvals at a glance</h2>
        <p class="lede">A quick peek at how Relicta keeps releases auditable and predictable.</p>
      </div>
      <div class="preview-grid">
        <div class="preview-card preview-media">
          <video autoplay loop muted playsinline poster="/brand/relicta-approval.png">
            <source src="/brand/relicta-approval.webm" type="video/webm" />
            <source src="/brand/relicta-approval.mp4" type="video/mp4" />
            <img src="/brand/relicta-approval.gif" alt="Relicta approval flow showing locks and publish gate" loading="lazy" />
          </video>
        </div>
        <div class="preview-card">
          <div class="preview-title">Release checklist</div>
          <div class="preview-rows">
            <div class="preview-row pulse"><span class="dot done"></span>Plan ready (version + diff)</div>
            <div class="preview-row pulse delay-1"><span class="dot done"></span>Notes drafted + changelog updated</div>
            <div class="preview-row pulse delay-2"><span class="dot pending"></span>Approval recorded</div>
            <div class="preview-row pulse delay-3"><span class="dot pending"></span>Publish: tags + plugins</div>
          </div>
          <div class="preview-title">Approvals</div>
          <div class="preview-rows">
            <div class="preview-row"><span class="dot done"></span> Approval recorded</div>
            <div class="preview-row"><span class="dot pending"></span> Waiting for final publish</div>
            <div class="preview-note">Approvals are tracked with timestamps and audit context.</div>
          </div>
        </div>
      </div>
    </section>

    <section class="section highlights reveal">
      <div class="section-heading">
        <p class="eyebrow">Quick looks</p>
        <h2>What a Relicta run looks like</h2>
        <p class="lede">A few stills from the new walkthrough so visitors can skim the flow without playing the video.</p>
      </div>
      <div class="highlight-grid">
        <figure class="highlight-card">
          <button class="highlight-zoom" type="button" data-src="/brand/relicta-highlight-01.png" data-alt="Relicta prompt ready for commands in a dark terminal" aria-label="Zoom: Minimal CLI ready for your release workflow">
            <img src="/brand/relicta-highlight-01.png" alt="Relicta prompt ready for commands in a dark terminal" loading="lazy" />
          </button>
          <figcaption>Minimal CLI ready for your release workflow.</figcaption>
        </figure>
        <figure class="highlight-card">
          <button class="highlight-zoom" type="button" data-src="/brand/relicta-highlight-02.png" data-alt="Relicta showing version plan and generated release notes" aria-label="Zoom: Automatic version planning and AI-crafted notes">
            <img src="/brand/relicta-highlight-02.png" alt="Relicta showing version plan and generated release notes" loading="lazy" />
          </button>
          <figcaption>Automatic version planning and AI-crafted notes.</figcaption>
        </figure>
        <figure class="highlight-card">
          <button class="highlight-zoom" type="button" data-src="/brand/relicta-highlight-03.png" data-alt="Relicta publishing release artifacts with checklist" aria-label="Zoom: Publish with checklists and audit-friendly output">
            <img src="/brand/relicta-highlight-03.png" alt="Relicta publishing release artifacts with checklist" loading="lazy" />
          </button>
          <figcaption>Publish with checklists and audit-friendly output.</figcaption>
        </figure>
      </div>
    </section>

    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const createLightbox = () => {
          const wrapper = document.createElement('div');
          wrapper.className = 'lightbox';
          wrapper.hidden = true;
          wrapper.setAttribute('aria-hidden', 'true');
          wrapper.innerHTML = `
            <div class="lightbox-backdrop" data-lightbox-close></div>
            <div class="lightbox-dialog" role="dialog" aria-modal="true" aria-label="Expanded highlight image">
              <button class="lightbox-close" type="button" data-lightbox-close aria-label="Close image">×</button>
              <img data-lightbox-image src="" alt="" />
            </div>
          `;
          document.body.appendChild(wrapper);
          return wrapper;
        };

        const lightbox = createLightbox();
        const dialog = lightbox.querySelector('.lightbox-dialog');
        const closeBtn = lightbox.querySelector('.lightbox-close');
        const imgEl = lightbox.querySelector('[data-lightbox-image]');
        const closeTriggers = lightbox.querySelectorAll('[data-lightbox-close]');
        let previouslyFocused = null;

        // Focus trap: keep focus within lightbox when open
        const trapFocus = (e) => {
          if (e.key !== 'Tab') return;

          const focusableElements = dialog.querySelectorAll(
            'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
          );
          const firstFocusable = focusableElements[0];
          const lastFocusable = focusableElements[focusableElements.length - 1];

          if (e.shiftKey) {
            if (document.activeElement === firstFocusable) {
              e.preventDefault();
              lastFocusable.focus();
            }
          } else {
            if (document.activeElement === lastFocusable) {
              e.preventDefault();
              firstFocusable.focus();
            }
          }
        };

        const open = (src, alt, triggerElement) => {
          previouslyFocused = triggerElement || document.activeElement;
          imgEl.src = src;
          imgEl.alt = alt || '';
          lightbox.hidden = false;
          lightbox.classList.add('open');
          lightbox.setAttribute('aria-hidden', 'false');
          document.body.style.overflow = 'hidden';

          // Move focus to close button
          closeBtn.focus();

          // Add focus trap
          lightbox.addEventListener('keydown', trapFocus);
        };

        const close = () => {
          lightbox.classList.remove('open');
          lightbox.hidden = true;
          imgEl.src = '';
          imgEl.alt = '';
          lightbox.setAttribute('aria-hidden', 'true');
          document.body.style.overflow = '';

          // Remove focus trap
          lightbox.removeEventListener('keydown', trapFocus);

          // Restore focus to triggering element
          if (previouslyFocused && previouslyFocused.focus) {
            previouslyFocused.focus();
          }
        };

        document.querySelectorAll('.highlight-zoom').forEach((btn) => {
          btn.addEventListener('click', () => {
            open(btn.dataset.src, btn.dataset.alt, btn);
          });
        });

        closeTriggers.forEach((el) => el.addEventListener('click', close));
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && !lightbox.hidden) {
            close();
          }
        });
      });
    </script>

    <section id="install" class="section install reveal">
      <div class="section-heading">
        <p class="eyebrow">Get started fast</p>
        <h2>Install the CLI</h2>
        <p class="lede">Pick your path: Homebrew, direct download, or Go install.</p>
      </div>
      <div class="install-video">
        <video controls width="100%" style="border-radius: 8px; max-width: 720px; margin: 0 auto 2rem; display: block;">
          <source src="/videos/quickstart.mp4" type="video/mp4" />
          Your browser does not support the video tag.
        </video>
        <p class="demo-note" style="text-align: center; margin-bottom: 2rem;">From install to first release in under 2 minutes</p>
      </div>
      <div class="install-grid">
        <div class="install-card">
          <h3>Homebrew</h3>
<pre><code>brew install relicta-tech/tap/relicta</code></pre>
        </div>
        <div class="install-card">
          <h3>Direct download</h3>
<pre><code>curl -L https://github.com/relicta-tech/\
relicta/releases/latest/download/relicta_\
Darwin_aarch64.tar.gz | tar xz
sudo mv relicta_Darwin_aarch64/relicta /usr/local/bin/</code></pre>
        </div>
        <div class="install-card">
          <h3>Go install</h3>
<pre><code>go install github.com/relicta-tech/relicta/cmd/relicta@latest</code></pre>
        </div>
      </div>
    </section>

    <section id="workflow" class="section workflow reveal">
      <div class="section-heading">
        <p class="eyebrow">Workflow</p>
        <h2>Two ways to release</h2>
        <p class="lede">Use one command for speed, or individual steps for control.</p>
      </div>
      <div class="workflow-options">
        <div class="workflow-option workflow-option-featured">
          <div class="workflow-option-header">
            <span class="workflow-badge">Recommended</span>
            <h3>One Command</h3>
          </div>
          <pre><code>relicta release</code></pre>
          <p>Runs the complete workflow: plan → bump → notes → approve → publish</p>
          <ul class="workflow-flags">
            <li><code>--yes</code> Auto-approve for CI/CD</li>
            <li><code>--dry-run</code> Preview without changes</li>
            <li><code>--force v2.0.0</code> Set specific version</li>
          </ul>
        </div>
        <div class="workflow-option">
          <h3>Step-by-Step</h3>
          <div class="workflow-steps">
            <div class="step">
              <span class="step-number">1</span>
              <div>
                <h4>Plan</h4>
                <p>Analyze commits, detect the right bump.</p>
              </div>
            </div>
            <div class="step">
              <span class="step-number">2</span>
              <div>
                <h4>Bump</h4>
                <p>Apply version, create git tag.</p>
              </div>
            </div>
            <div class="step">
              <span class="step-number">3</span>
              <div>
                <h4>Notes</h4>
                <p>Generate AI-powered release notes.</p>
              </div>
            </div>
            <div class="step">
              <span class="step-number">4</span>
              <div>
                <h4>Approve</h4>
                <p>Lock the plan with audit context.</p>
              </div>
            </div>
            <div class="step">
              <span class="step-number">5</span>
              <div>
                <h4>Publish</h4>
                <p>Tag repo, run plugins, post release.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="section stakeholders reveal">
      <div class="section-heading">
        <p class="eyebrow">For stakeholders</p>
        <h2>Less release risk, more confidence</h2>
        <p class="lede">Relicta shortens release prep, reduces hotfixes, and keeps an audit trail so leadership and compliance teams stay aligned.</p>
      </div>
      <div class="stakeholder-grid">
        <div class="card">
          <h3>Business outcomes</h3>
          <ul>
            <li>Predictable release cadence with fewer fire drills</li>
            <li>Consistent changelogs for customers and internal teams</li>
            <li>Lower engineer toil; more time for features</li>
          </ul>
        </div>
        <div class="card">
          <h3>Trust & safety</h3>
          <ul>
            <li>Audit-friendly approval step with recorded decisions</li>
            <li>Uses your AI keys; nothing stored server-side</li>
            <li>Open source (MIT); transparent build artifacts</li>
          </ul>
        </div>
        <div class="card">
          <h3>Need a demo?</h3>
          <p>Security review or SLA? Talk to us.</p>
          <div class="hero-actions">
            <a class="btn solid" href="mailto:hello@relicta.tech">Book a demo</a>
            <a class="btn ghost" href="https://docs.relicta.tech" target="_blank" rel="noopener">Read the docs</a>
          </div>
        </div>
      </div>
    </section>

    <section class="section cta-band reveal-scale">
      <div>
        <h2>Ready to ship your next release?</h2>
        <p class="lede">Install Relicta and keep your releases consistent, auditable, and stress-free.</p>
      </div>
      <div class="hero-actions">
        <a class="btn solid" href="#install">Install the CLI</a>
        <a class="btn ghost" href="https://github.com/relicta-tech/relicta" target="_blank" rel="noopener">Star on GitHub</a>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="brand">
      <div class="brand-logos">
        <img src="/brand/relicta-icon-light.svg" alt="Relicta" class="brand-icon icon-light" />
        <img src="/brand/relicta-icon-dark.svg" alt="Relicta" class="brand-icon icon-dark" />
      </div>
      <span>Relicta — Release management, automated.</span>
    </div>
    <div class="footer-links">
      <a href="https://github.com/relicta-tech/relicta" target="_blank" rel="noopener">CLI Source</a>
      <a href="https://github.com/relicta-tech/relicta-action" target="_blank" rel="noopener">GitHub Action</a>
      <a href="https://docs.relicta.tech" target="_blank" rel="noopener">Docs</a>
    </div>
  </footer>
</BaseLayout>
