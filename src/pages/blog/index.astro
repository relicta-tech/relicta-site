---
import { getCollection } from 'astro:content';
import SiteLayout from "../../layouts/SiteLayout.astro";

const posts = (await getCollection('blog', ({ data }) => {
	return data.draft !== true;
})).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const title = "Relicta Blog";
const description = "Thoughts on change governance, AI agents, and software delivery.";
---
<SiteLayout {title} {description}>
  <section class="hero">
    <div class="hero-text">
      <h1>Blog</h1>
      <p class="lede">Thinking about the future of software change.</p>
    </div>
  </section>

  <section class="section">
    <div class="grid">
        {posts.map((post) => (
            <a href={`/blog/${post.slug}`} class="card-link">
                <article class="card">
                    <p class="eyebrow">{post.data.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</p>
                    <h3>{post.data.title}</h3>
                    <p>{post.data.description}</p>
                </article>
            </a>
        ))}
        {posts.length === 0 && (
            <p>No blog posts yet. Stay tuned!</p>
        )}
    </div>
  </section>
</SiteLayout>

<style>
    .card-link {
        display: block;
        text-decoration: none;
        color: inherit;
    }
    .card-link:hover .card {
        border-color: var(--color-accent);
        transform: translateY(-4px);
    }
</style>